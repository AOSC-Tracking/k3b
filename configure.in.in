#MIN_CONFIG

AM_INIT_AUTOMAKE(k3b,0.5.2)

AC_MSG_CHECKING(for cdparanoia libraries and headers)

#checking for cdparanoia (from audiocd-ioslave)

with_cdparanoia=NOTFOUND
search_incs="$kde_includes /usr/include /usr/local/include"
AC_FIND_FILE(cdda_interface.h, $search_incs, para_incdir)
if test -r $para_incdir/cdda_interface.h ; then
  test "x$para_incdir" != "x/usr/include" && CDPARANOIA_INCS="-I$para_incdir"
  with_cdparanoia=FOUND
fi
if test $with_cdparanoia = FOUND ; then
  with_cdparanoia=NOTFOUND
  # because of the horrible hack we need shared cdparanoia
  AC_FIND_FILE(libcdda_paranoia.so, $kde_libraries /usr/lib /usr/local/lib, para_libdir)
  if test -r $para_libdir/libcdda_paranoia.so ; then
    if test "x$para_libdir" != "x/usr/lib" ; then
      CDPARANOIA_LIBS="-L$para_libdir "
    fi
    CDPARANOIA_LIBS="${CDPARANOIA_LIBS}-lcdda_paranoia -lcdda_interface"
    with_cdparanoia=FOUND
  fi
fi


case "$with_cdparanoia" in
NOTFOUND) AC_MSG_ERROR(could not find cdparanoia includes and library) ;;
*)        AC_MSG_RESULT(incs=$para_incdir libs=$para_libdir) ;;
esac

AC_SUBST(CDPARANOIA_INCS)
AC_SUBST(CDPARANOIA_LIBS)


#checking libid3
AC_MSG_CHECKING(for ID3Lib)

AC_ARG_WITH(id3lib_includes,
  [  --with-id3lib-includes=DIR   where the id3lib includes are.],
  [
    ID3LIB_USER_INCLUDES=$withval
  ])

AC_ARG_WITH(id3lib_libraries,
  [  --with-id3lib-libraries=DIR  where the id3lib libraries are installed.],
  [
    ID3LIB_USER_LIBRARIES=$withval
  ])


with_id3lib=NOTFOUND
search_incs="$ID3LIB_USER_INCLUDES $kde_includes /usr/include /usr/local/include"
AC_FIND_FILE(id3/tag.h, $search_incs, para_incdir)
if test -r $para_incdir/id3/tag.h ; then
  test "x$para_incdir" != "x/usr/include" && ID3LIB_INCS="-I$para_incdir"
  with_id3lib=FOUND
fi
if test $with_id3lib = FOUND ; then
  with_id3lib=NOTFOUND
  search_libs="$ID3LIB_USER_LIBRARIES $kde_libraries /usr/lib /usr/local/lib"
  AC_FIND_FILE(libid3.so, $search_libs, para_libdir)
  if test -r $para_libdir/libid3.so ; then
    if test "x$para_libdir" != "x/usr/lib" ; then
      ID3LIB_LIBS="-L$para_libdir "
    fi
    ID3LIB_LIBS="${ID3LIB_LIBS}-lid3"
    with_id3lib=FOUND
  fi
fi

case "$with_id3lib" in
NOTFOUND) AC_MSG_ERROR(Could not find ID3Lib. Refere to INSTALL) ;;
FOUND)    AC_MSG_RESULT(incs=$para_incdir libs=$para_libdir) ;;
esac

AC_SUBST(ID3LIB_INCS)
AC_SUBST(ID3LIB_LIBS)
